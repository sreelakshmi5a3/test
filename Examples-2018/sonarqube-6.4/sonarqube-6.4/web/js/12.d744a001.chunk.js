webpackJsonp([12],{206:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o=n(19),s=i(o);t.default=s.default.Model.extend({idAttribute:"id",urlRoot:function(){return window.baseUrl+"/api/metrics"},sync:function(e,t,n){var i=n||{};return"create"===e&&(0,a.defaults)(i,{url:this.urlRoot()+"/create",type:"POST",data:(0,a.pick)(t.toJSON(),"key","name","description","domain","type")}),"update"===e&&(0,a.defaults)(i,{url:this.urlRoot()+"/update",type:"POST",data:(0,a.pick)(t.toJSON(),"id","key","name","description","domain","type")}),"delete"===e&&(0,a.defaults)(i,{url:this.urlRoot()+"/delete",type:"POST",data:{ids:this.id}}),s.default.ajax(i)}})},272:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(19),o=i(a),s=n(206),r=i(s);t.default=o.default.Collection.extend({model:r.default,url:function(){return window.baseUrl+"/api/metrics/search"},parse:function(e){return this.total=e.total,this.p=e.p,this.ps=e.ps,e.metrics},fetch:function(e){var t=Object.assign({data:{}},e);return this.q=t.data.q,t.data.isCustom=!0,o.default.Collection.prototype.fetch.call(this,t)},fetchMore:function(){var e=this.p+1;return this.fetch({add:!0,remove:!1,data:{p:e,ps:this.ps,q:this.q}})},refresh:function(){return this.fetch({reset:!0,data:{q:this.q}})},hasMore:function(){return this.total>this.p*this.ps}})},441:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(14),o=i(a),s=n(17),r=i(s),l=n(1669),c=i(l);t.default=r.default.extend({template:c.default,onRender:function(){var e=this;r.default.prototype.onRender.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),this.$("#create-metric-domain").select2({width:"250px",createSearchChoice:function(e){return{id:e,text:"+"+e}},createSearchChoicePosition:"top",initSelection:function(e,t){var n=(0,o.default)(e).val();t({id:n,text:n})},query:function(t){var n=e.options.domains.filter(function(e){return e.toLowerCase().indexOf(t.term.toLowerCase())!==-1}),i=n.map(function(e){return{id:e,text:e}});t.callback({results:i,more:!1})}}).select2("val",this.model&&this.model.get("domain")),this.$("#create-metric-type").select2({width:"250px"})},onDestroy:function(){r.default.prototype.onDestroy.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip("destroy")},onFormSubmit:function(){r.default.prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},serializeData:function(){return Object.assign({},r.default.prototype.serializeData.apply(this,arguments),{domains:this.options.domains,types:this.options.types})}})},948:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(1),c=i(l),u=n(15),d=i(u),f=n(952),p=i(f),m=n(2),h=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),r(t,[{key:"componentDidMount",value:function(){(0,p.default)(this.refs.container)}},{key:"render",value:function(){return c.default.createElement("div",null,c.default.createElement(d.default,{title:(0,m.translate)("custom_metrics.page")}),c.default.createElement("div",{ref:"container"}))}}]),t}(c.default.PureComponent);t.default=h},949:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(206),o=i(a),s=n(441),r=i(s);t.default=r.default.extend({sendRequest:function(){var e=this,t=new o.default({key:this.$("#create-metric-key").val(),name:this.$("#create-metric-name").val(),description:this.$("#create-metric-description").val(),domain:this.$("#create-metric-domain").val(),type:this.$("#create-metric-type").val()});return this.disableForm(),t.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.options.domains.indexOf(t.get("domain"))===-1&&e.options.domains.push(t.get("domain")),e.destroy()}).fail(function(t){e.showErrors(t.responseJSON.errors,t.responseJSON.warnings),e.enableForm()})}})},950:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(17),o=i(a),s=n(1668),r=i(s);t.default=o.default.extend({template:r.default,onFormSubmit:function(){o.default.prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},sendRequest:function(){var e=this,t=this.model.collection;return this.model.destroy({wait:!0,statusCode:{400:null}}).done(function(){t.refresh(),e.destroy()}).fail(function(t){e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},951:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),o=i(a),s=n(949),r=i(s),l=n(1670),c=i(l);t.default=o.default.ItemView.extend({template:c.default,events:{"click #metrics-create":"onCreateClick"},onCreateClick:function(e){e.preventDefault(),this.createMetric()},createMetric:function(){new r.default({collection:this.collection,domains:this.options.domains,types:this.options.types,app:this.options.app}).render()}})},952:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){b.start(e)};var a=n(14),o=i(a),s=n(11),r=i(s),l=n(953),c=i(l),u=n(272),d=i(u),f=n(951),p=i(f),m=n(956),h=i(m),v=n(954),y=i(v),b=new r.default.Application,g=function(e){this.layout=new c.default({el:e}),this.layout.render(),this.metrics=new d.default,this.headerView=new p.default({collection:this.metrics,domains:this.domains,types:this.types,app:b}),this.layout.headerRegion.show(this.headerView),this.listView=new h.default({collection:this.metrics,domains:this.domains,types:this.types}),this.layout.listRegion.show(this.listView),this.listFooterView=new y.default({collection:this.metrics}),this.layout.listFooterRegion.show(this.listFooterView),this.metrics.fetch()};b.requestDomains=function(){return o.default.get(window.baseUrl+"/api/metrics/domains").done(function(e){b.domains=e.domains})},b.requestTypes=function(){return o.default.get(window.baseUrl+"/api/metrics/types").done(function(e){b.types=e.types})},b.on("start",function(e){o.default.when(b.requestDomains(),b.requestTypes()).done(function(){g.call(b,e)})})},953:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),o=i(a),s=n(1671),r=i(s);t.default=o.default.LayoutView.extend({template:r.default,regions:{headerRegion:"#metrics-header",listRegion:"#metrics-list",listFooterRegion:"#metrics-list-footer"}})},954:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),o=i(a),s=n(1672),r=i(s);t.default=o.default.ItemView.extend({template:r.default,collectionEvents:{all:"render"},events:{"click #metrics-fetch-more":"onMoreClick"},onMoreClick:function(e){e.preventDefault(),this.fetchMore()},fetchMore:function(){this.collection.fetchMore()},serializeData:function(){return Object.assign({},o.default.ItemView.prototype.serializeData.apply(this,arguments),{total:this.collection.total,count:this.collection.length,more:this.collection.hasMore()})}})},955:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),o=i(a),s=n(958),r=i(s),l=n(950),c=i(l),u=n(1673),d=i(u);t.default=o.default.ItemView.extend({tagName:"li",className:"panel panel-vertical",template:d.default,events:{"click .js-metric-update":"onUpdateClick","click .js-metric-delete":"onDeleteClick"},onRender:function(){this.$el.attr("data-id",this.model.id).attr("data-key",this.model.get("key")),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"})},onDestroy:function(){this.$('[data-toggle="tooltip"]').tooltip("destroy")},onUpdateClick:function(e){e.preventDefault(),this.updateMetric()},onDeleteClick:function(e){e.preventDefault(),this.deleteMetric()},updateMetric:function(){new r.default({model:this.model,collection:this.model.collection,types:this.options.types,domains:this.options.domains}).render()},deleteMetric:function(){new c.default({model:this.model}).render()}})},956:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),o=i(a),s=n(955),r=i(s);t.default=o.default.CollectionView.extend({tagName:"ul",childView:r.default,childViewOptions:function(){return{types:this.options.types,domains:this.options.domains}}})},958:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(441),o=i(a);t.default=o.default.extend({sendRequest:function(){var e=this;return this.model.set({key:this.$("#create-metric-key").val(),name:this.$("#create-metric-name").val(),description:this.$("#create-metric-description").val(),domain:this.$("#create-metric-domain").val(),type:this.$("#create-metric-type").val()}),this.disableForm(),this.model.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.destroy()}).fail(function(t){e.enableForm(),e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},1668:function(e,t,n){var i=n(5);e.exports=(i.default||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,o="function",s=t.helperMissing,r=this.escapeExpression;return'<form id="delete-metric-form">\n  <div class="modal-head">\n    <h2>Delete Metric</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n    Are you sure you want to delete metric "'+r((a=null!=(a=t.name||(null!=e?e.name:e))?a:s,typeof a===o?a.call(e,{name:"name",hash:{},data:i}):a))+'"?\n  </div>\n  <div class="modal-foot">\n    <button id="delete-metric-submit" class="button-red">Delete</button>\n    <a href="#" class="js-modal-close" id="delete-metric-cancel">Cancel</a>\n  </div>\n</form>\n'},useData:!0})},1669:function(e,t,n){var i=n(5);e.exports=(i.default||i).template({1:function(e,t,n,i){return"Update"},3:function(e,t,n,i){return"Create"},5:function(e,t,i,a,o){var s,r=this.lambda,l=this.escapeExpression,c='          <option value="'+l(r(e,e))+'" ';return s=n(13).call(e,e,null!=o[1]?o[1].type:o[1],{name:"eq",hash:{},fn:this.program(6,a,o),inverse:this.noop,data:a}),null!=s&&(c+=s),c+">"+l(n(3).call(e,"metric.type",e,{name:"t",hash:{},data:a}))+"</option>\n"},6:function(e,t,n,i){return"selected"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i,a){var o,s=this.lambda,r=this.escapeExpression,l='<form id="create-metric-form" autocomplete="off">\n  <div class="modal-head">\n    <h2>';return o=t.if.call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(1,i,a),inverse:this.program(3,i,a),data:i}),null!=o&&(l+=o),l+=' Metric</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n    <div class="modal-field">\n      <label for="create-metric-key">Key<em class="mandatory">*</em></label>\n      <input id="create-metric-key" name="key" type="text" maxlength="200" required value="'+r(s(null!=e?e.key:e,e))+'">\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-name">Name<em class="mandatory">*</em></label>\n      <input id="create-metric-name" name="name" type="text" maxlength="200" required value="'+r(s(null!=e?e.name:e,e))+'">\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-description">Description</label>\n      <textarea id="create-metric-description" name="description">'+r(s(null!=e?e.description:e,e))+'</textarea>\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-domain">Domain</label>\n      <input id="create-metric-domain" name="domain" type="text" maxlength="200" value="'+r(s(null!=e?e.domain:e,e))+'">\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-type">Type<em class="mandatory">*</em></label>\n      <select id="create-metric-type" name="type">\n',o=t.each.call(e,null!=e?e.types:e,{name:"each",hash:{},fn:this.program(5,i,a),inverse:this.noop,data:i}),null!=o&&(l+=o),l+='      </select>\n    </div>\n  </div>\n  <div class="modal-foot">\n    <button id="create-metric-submit">',o=t.if.call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(1,i,a),inverse:this.program(3,i,a),data:i}),null!=o&&(l+=o),l+'</button>\n    <a href="#" class="js-modal-close" id="create-metric-cancel">Cancel</a>\n  </div>\n</form>\n'},useData:!0,useDepths:!0})},1670:function(e,t,n){var i=n(5);e.exports=(i.default||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<header class="page-header">\n  <h1 class="page-title">Custom Metrics</h1>\n  <div class="page-actions">\n    <div class="button-group">\n      <button id="metrics-create">Create Metric</button>\n    </div>\n  </div>\n  <p class="page-description">These metrics are available for all projects. Manual measures can be set at project level\n    via the configuration interface.</p>\n</header>\n'},useData:!0})},1671:function(e,t,n){var i=n(5);e.exports=(i.default||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="page">\n  <div id="metrics-header"></div>\n  <div id="metrics-list"></div>\n  <div id="metrics-list-footer"></div>\n</div>\n'},useData:!0})},1672:function(e,t,n){var i=n(5);e.exports=(i.default||i).template({1:function(e,t,n,i){return'    <a id="metrics-fetch-more" class="spacer-left" href="#">show more</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,o,s="function",r=t.helperMissing,l=this.escapeExpression,c='<footer class="spacer-top note text-center">\n  '+l((o=null!=(o=t.count||(null!=e?e.count:e))?o:r,typeof o===s?o.call(e,{name:"count",hash:{},data:i}):o))+"/"+l((o=null!=(o=t.total||(null!=e?e.total:e))?o:r,typeof o===s?o.call(e,{name:"total",hash:{},data:i}):o))+" shown\n";return a=t.if.call(e,null!=e?e.more:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(c+=a),c+"</footer>\n"},useData:!0})},1673:function(e,t,n){var i=n(5);e.exports=(i.default||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,a){var o=this.lambda,s=this.escapeExpression;return'<div class="pull-right big-spacer-left nowrap">\n  <a class="js-metric-update icon-edit" title="Update" data-toggle="tooltip" href="#"></a>\n  <a class="js-metric-delete icon-delete" title="Delete" data-toggle="tooltip" href="#"></a>\n</div>\n\n<div class="display-inline-block text-top width-30">\n  <div>\n    <strong class="js-metric-name">'+s(o(null!=e?e.name:e,e))+'</strong>\n    <span class="js-metric-key note little-spacer-left">'+s(o(null!=e?e.key:e,e))+'</span>\n  </div>\n</div>\n\n<div class="display-inline-block text-top width-20">\n  <span class="js-metric-domain">'+s(o(null!=e?e.domain:e,e))+'</span>\n</div>\n\n<div class="display-inline-block text-top width-20">\n  <span class="js-metric-type">'+s(n(3).call(e,"metric.type",null!=e?e.type:e,{name:"t",hash:{},data:a}))+'</span>\n</div>\n\n<div class="display-inline-block text-top width-20">\n  <span class="js-metric-description">'+s(o(null!=e?e.description:e,e))+"</span>\n</div>\n"},useData:!0})}});