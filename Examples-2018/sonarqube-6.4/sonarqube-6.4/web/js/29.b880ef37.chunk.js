webpackJsonp([29],{58:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){return o}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=n(1),s=r(i),o=s.default.createElement("i",{className:"spinner spinner-margin"})},131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAnalysis=t.changeEvent=t.deleteEvent=t.createEvent=t.getProjectActivity=void 0;var r=n(21);t.getProjectActivity=function(e,t){var n={project:e};return t&&(t.category&&(n.category=t.category),t.pageIndex&&(n.p=t.pageIndex),t.pageSize&&(n.ps=t.pageSize)),(0,r.getJSON)("/api/project_analyses/search",n)},t.createEvent=function(e,t,n,a){var i={analysis:e,name:t};return n&&(i.category=n),a&&(i.description=a),(0,r.postJSON)("/api/project_analyses/create_event",i).then(function(e){return e.event})},t.deleteEvent=function(e){return(0,r.post)("/api/project_analyses/delete_event",{event:e})},t.changeEvent=function(e,t,n){var a={event:e};return t&&(a.name=t),n&&(a.description=n),(0,r.postJSON)("/api/project_analyses/update_event",a).then(function(e){return e.event})},t.deleteAnalysis=function(e){return(0,r.post)("/api/project_analyses/delete",{analysis:e})}},249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeMachineData=void 0;var r=n(21);t.getTimeMachineData=function(e,t,n){return(0,r.getJSON)("/api/measures/search_history",Object.assign({component:e,metrics:t.join(),ps:1e3},n))}},860:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),c=n(6),l=r(c),p=n(1),d=r(p),f=n(58),h=r(f),m=n(1328),v=r(m),y=n(249),g=n(131),E=n(16),b=n(2),_=500,k=d.default.createElement(h.default,null),T=function(e){function t(){var e,n,r,s;a(this,t);for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.state={components:[],selected:null,fetching:!0},s=n,i(r,s)}return s(t,e),o(t,[{key:"componentDidMount",value:function(){this.mounted=!0,this.fetchHistory()}},{key:"componentDidUpdate",value:function(e){e.metric!==this.props.metric&&this.fetchHistory()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"fetchHistory",value:function(){var e=this,t=this.props.metric;Promise.all([this.fetchTimeMachineData(t.key),this.fetchEvents()]).then(function(t){e.mounted&&e.setState({snapshots:t[0],events:t[1],fetching:!1})})}},{key:"fetchTimeMachineData",value:function(e,t){var n=[e];return t&&n.push(t),(0,y.getTimeMachineData)(this.props.component.key,n).then(function(e){return 0===e.measures.length?[]:e.measures[0].history.map(function(e){return{date:(0,l.default)(e.date).toDate(),value:e.value}})})}},{key:"fetchEvents",value:function(){return"TRK"!==this.props.component.qualifier?Promise.resolve([]):(0,g.getProjectActivity)(this.props.component.key,{category:"VERSION"}).then(function(e){var t=e.analyses,n=t.map(function(e){var t=e.events.find(function(e){return"VERSION"===e.category});return{version:t.name,date:(0,l.default)(e.date).toDate()}});return(0,u.sortBy)(n,"date")})}},{key:"renderLineChart",value:function(e,t){if(!t)return null;if(e.length<2)return this.renderWhenNoHistoricalData();var n=e.map(function(e){return{x:e.date,y:"LEVEL"===t.type?e.value:Number(e.value)}}),r=function(e){return(0,E.formatMeasure)(e,t.type)},a=function(e){return(0,E.formatMeasure)(e,(0,E.getShortType)(t.type))};return d.default.createElement("div",{style:{height:_}},d.default.createElement(v.default,{basisCurve:!1,key:t.key,data:n,metricType:t.type,events:this.state.events,height:_,interpolate:"linear",formatValue:r,formatYTick:a,leakPeriodDate:this.props.leakPeriodDate,padding:[25,25,25,60]}))}},{key:"render",value:function(){var e=this.state,t=e.fetching,n=e.snapshots;return t?d.default.createElement("div",{className:"measure-details-history"},d.default.createElement("div",{className:"note text-center",style:{lineHeight:_+"px"}},k)):!n||n.length<2?d.default.createElement("div",{className:"measure-details-history"},d.default.createElement("div",{className:"note text-center",style:{lineHeight:_+"px"}},(0,b.translate)("component_measures.no_history"))):d.default.createElement("div",{className:"measure-details-history"},this.renderLineChart(this.state.snapshots,this.props.metric))}}]),t}(d.default.PureComponent);t.default=T},861:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),i=n(860),s=r(i),o=n(8),u=function(e){return{component:(0,o.getMeasuresAppComponent)(e),metric:(0,o.getMeasuresAppDetailsMetric)(e)}},c=function(){return{}};t.default=(0,a.connect)(u,c)(s.default)},1328:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(14),s=r(i),o=n(6),u=r(o),c=n(1),l=r(c),p=n(79),d=n(80),f=n(189),h=n(101),m=n(31),v=l.default.createElement("div",null),y=l.default.createClass({displayName:"Timeline",propTypes:{data:l.default.PropTypes.arrayOf(l.default.PropTypes.object).isRequired,padding:l.default.PropTypes.arrayOf(l.default.PropTypes.number),height:l.default.PropTypes.number,basisCurve:l.default.PropTypes.bool},mixins:[h.ResizeMixin,m.TooltipsMixin],getDefaultProps:function(){return{padding:[10,10,10,10],basisCurve:!0}},getInitialState:function(){return{width:this.props.width,height:this.props.height}},getRatingScale:function(e){return(0,d.scalePoint)().domain([5,4,3,2,1]).range([e,0])},getLevelScale:function(e){return(0,d.scalePoint)().domain(["ERROR","WARN","OK"]).range([e,0])},getYScale:function(e){return"RATING"===this.props.metricType?this.getRatingScale(e):"LEVEL"===this.props.metricType?this.getLevelScale(e):(0,d.scaleLinear)().range([e,0]).domain([0,(0,p.max)(this.props.data,function(e){return e.y||0})]).nice()},handleEventMouseEnter:function(e){(0,s.default)(".js-event-circle-"+e.date.getTime()).tooltip("show")},handleEventMouseLeave:function(e){(0,s.default)(".js-event-circle-"+e.date.getTime()).tooltip("hide")},renderHorizontalGrid:function(e,t){var n=this,r="function"==typeof t.ticks,i=r?t.ticks(4):t.domain();i.length||i.push(t.domain()[1]);var s=i.map(function(r){var i={x:e.range()[0],y:t(r)};return l.default.createElement("g",{key:r},l.default.createElement("text",a({className:"line-chart-tick line-chart-tick-x",dx:"-1em",dy:"0.3em",textAnchor:"end"},i),n.props.formatYTick(r)),l.default.createElement("line",{className:"line-chart-grid",x1:e.range()[0],x2:e.range()[1],y1:t(r),y2:t(r)}))});return l.default.createElement("g",null,s)},renderTicks:function(e,t){var n=e.tickFormat(7),r=e.ticks(7);return r=r.slice(0,-1).map(function(a,i){var s=i+1<r.length?r[i+1]:e.domain()[1],o=(e(a)+e(s))/2,u=t.range()[0];return l.default.createElement("text",{key:i,className:"line-chart-tick",x:o,y:u,dy:"1.5em"},n(a))}),l.default.createElement("g",null,r)},renderLeak:function(e,t){if(!this.props.leakPeriodDate)return null;var n=t.range(),r={x:e(this.props.leakPeriodDate),y:n[n.length-1],width:e.range()[1]-e(this.props.leakPeriodDate),height:n[0]-n[n.length-1],fill:"#fbf3d5"};return l.default.createElement("rect",r)},renderLine:function(e,t){var n=(0,f.line)().x(function(t){return e(t.x)}).y(function(e){return t(e.y)});return this.props.basisCurve&&n.curve(f.curveBasis),l.default.createElement("path",{className:"line-chart-path",d:n(this.props.data)})},renderEvents:function(e,t){var n=this,r=this.props.events.map(function(e){var t=n.props.data.find(function(t){return t.x.getTime()===e.date.getTime()});return Object.assign({},e,{snapshot:t})}).filter(function(e){return e.snapshot}).map(function(r){var a=r.date.getTime()+"-"+r.snapshot.y,i="line-chart-point js-event-circle-"+r.date.getTime(),s=r.snapshot.y?n.props.formatValue(r.snapshot.y):"â€”",o=['<span class="nowrap">'+r.version+"</span>",'<span class="nowrap">'+(0,u.default)(r.date).format("LL")+"</span>",'<span class="nowrap">'+s+"</span>"].join("<br>");return l.default.createElement("circle",{key:a,className:i,r:"4",cx:e(r.snapshot.x),cy:t(r.snapshot.y),onMouseEnter:n.handleEventMouseEnter.bind(n,r),onMouseLeave:n.handleEventMouseLeave.bind(n,r),"data-toggle":"tooltip","data-title":o})});return l.default.createElement("g",null,r)},render:function(){if(!this.state.width||!this.state.height)return v;var e=this.state.width-this.props.padding[1]-this.props.padding[3],t=this.state.height-this.props.padding[0]-this.props.padding[2],n=(0,d.scaleTime)().domain((0,p.extent)(this.props.data,function(e){return e.x||0})).range([0,e]).clamp(!0),r=this.getYScale(t);return l.default.createElement("svg",{className:"line-chart",width:this.state.width,height:this.state.height},l.default.createElement("g",{transform:"translate("+this.props.padding[3]+", "+this.props.padding[0]+")"},this.renderLeak(n,r),this.renderHorizontalGrid(n,r),this.renderTicks(n,r),this.renderLine(n,r),this.renderEvents(n,r)))}});t.default=y}});