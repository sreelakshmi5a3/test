webpackJsonp([28],{255:function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.removeNotification=t.addNotification=t.fetchNotifications=void 0;var r=n(692),i=o(r),a=n(48),c=n(317);t.fetchNotifications=function(){return function(e){var t=function(t){var n=t.notifications.filter(function(e){return e.organization}).map(function(e){return e.organization});e((0,a.fetchOrganizations)(n)).then(function(){e((0,c.receiveNotifications)(t.notifications,t.channels,t.globalTypes,t.perProjectTypes))})};return i.getNotifications().then(t,(0,a.onFail)(e))}},t.addNotification=function(e){return function(t){return i.addNotification(e.channel,e.type,e.project).then(function(){return t((0,c.addNotification)(e))},(0,a.onFail)(t))}},t.removeNotification=function(e){return function(t){return i.removeNotification(e.channel,e.type,e.project).then(function(){return t((0,c.removeNotification)(e))},(0,a.onFail)(t))}}},413:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),u=o(l),f=n(100),s=o(f),p=n(2),d=(n(317),function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"isEnabled",value:function(e,t){return!!this.props.notifications.find(function(n){return n.type===e&&n.channel===t})}},{key:"handleCheck",value:function(e,t,n){n?this.props.onAdd({type:e,channel:t}):this.props.onRemove({type:e,channel:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.channels,o=t.checkboxId,r=t.types;return u.default.createElement("tbody",null,r.map(function(t){return u.default.createElement("tr",{key:t},u.default.createElement("td",null,(0,p.translate)("notification.dispatcher",t)),n.map(function(n){return u.default.createElement("td",{key:n,className:"text-center"},u.default.createElement(s.default,{checked:e.isEnabled(t,n),id:o(t,n),onCheck:function(o){return e.handleCheck(t,n,o)}}))}))}))}}]),t}(u.default.PureComponent));t.default=d},692:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeNotification=t.addNotification=t.getNotifications=void 0;var o=n(21);t.getNotifications=function(){return(0,o.getJSON)("/api/notifications/list")},t.addNotification=function(e,t,n){var r={channel:e,type:t};return n&&Object.assign(r,{project:n}),(0,o.post)("/api/notifications/add",r)},t.removeNotification=function(e,t,n){var r={channel:e,type:t};return n&&Object.assign(r,{project:n}),(0,o.post)("/api/notifications/remove",r)}},754:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return a.default.createElement("section",null,a.default.createElement("h2",{className:"spacer-bottom"},(0,f.translate)("my_profile.overall_notifications.title")),a.default.createElement("table",{className:"form"},a.default.createElement("thead",null,a.default.createElement("tr",null,d,e.channels.map(function(e){return a.default.createElement("th",{key:e,className:"text-center"},a.default.createElement("h4",null,(0,f.translate)("notification.channel",e)))}))),a.default.createElement(u.default,{notifications:e.notifications,channels:e.channels,types:e.types,checkboxId:function(e,t){return"global-notification-"+e+"-"+t},onAdd:e.addNotification,onRemove:e.removeNotification})))}Object.defineProperty(t,"__esModule",{value:!0}),t.UnconnectedGlobalNotifications=void 0;var i=n(1),a=o(i),c=n(7),l=n(413),u=o(l),f=n(2),s=n(8),p=n(255),d=a.default.createElement("th",null),h=function(e){return{notifications:(0,s.getGlobalNotifications)(e),channels:(0,s.getNotificationChannels)(e),types:(0,s.getNotificationGlobalTypes)(e)}},y={addNotification:p.addNotification,removeNotification:p.removeNotification};t.default=(0,c.connect)(h,y)(r);t.UnconnectedGlobalNotifications=r},755:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UnconnectedNotifications=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),u=o(l),f=n(15),s=o(f),p=n(7),d=n(754),h=o(d),y=n(757),m=o(y),b=n(2),v=n(255),j=u.default.createElement(h.default,null),_=u.default.createElement("hr",{className:"account-separator"}),N=u.default.createElement(m.default,null),g=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"componentDidMount",value:function(){this.props.fetchNotifications()}},{key:"render",value:function(){return u.default.createElement("div",{className:"account-body account-container"},u.default.createElement(s.default,{title:(0,b.translate)("my_account.notifications")}),u.default.createElement("p",{className:"big-spacer-bottom"},(0,b.translate)("notification.dispatcher.information")),j,_,N)}}]),t}(u.default.PureComponent),E={fetchNotifications:v.fetchNotifications};t.default=(0,p.connect)(null,E)(g);t.UnconnectedNotifications=g},756:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UnconnectedProjectNotifications=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),u=o(l),f=n(7),s=n(9),p=n(413),d=o(p),h=n(137),y=o(h),m=n(2),b=n(8),v=n(255),j=n(20),_=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"handleAddNotification",value:function(e){var t=e.channel,n=e.type;this.props.addNotification({channel:t,type:n,project:this.props.project.key,projectName:this.props.project.name,organization:this.props.project.organization})}},{key:"handleRemoveNotification",value:function(e){var t=e.channel,n=e.type;this.props.removeNotification({channel:t,type:n,project:this.props.project.key})}},{key:"render",value:function(){var e=this,t=this.props,n=t.project,o=t.channels;return u.default.createElement("table",{key:n.key,className:"form big-spacer-bottom"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",null,u.default.createElement("span",{className:"text-normal"},u.default.createElement(y.default,{organizationKey:n.organization})),u.default.createElement("h4",{className:"display-inline-block"},u.default.createElement(s.Link,{to:(0,j.getProjectUrl)(n.key)},n.name))),o.map(function(e){return u.default.createElement("th",{key:e,className:"text-center"},u.default.createElement("h4",null,(0,m.translate)("notification.channel",e)))}))),u.default.createElement(d.default,{notifications:this.props.notifications,channels:this.props.channels,types:this.props.types,checkboxId:function(e,t){return"project-notification-"+n.key+"-"+e+"-"+t},onAdd:function(t){return e.handleAddNotification(t)},onRemove:function(t){return e.handleRemoveNotification(t)}}))}}]),t}(u.default.PureComponent),N=function(e,t){return{notifications:(0,b.getProjectNotifications)(e,t.project.key),channels:(0,b.getNotificationChannels)(e),types:(0,b.getNotificationPerProjectTypes)(e)}},g={addNotification:v.addNotification,removeNotification:v.removeNotification};t.default=(0,f.connect)(N,g)(_);t.UnconnectedProjectNotifications=_},757:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UnconnectedProjects=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),f=o(u),s=n(33),p=o(s),d=n(7),h=n(4),y=n(756),m=o(y),b=n(137),v=o(b),j=n(2),_=n(30),N=n(8),g=f.default.createElement("span",{className:"text-middle spacer-right"},"Set notifications for:"),E=function(e){function t(){var e,n,o,c;i(this,t);for(var l=arguments.length,u=Array(l),s=0;s<l;s++)u[s]=arguments[s];return n=o=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),o.state={addedProjects:[]},o.loadOptions=function(e,t){return e.length<2?void t(null,{options:[]}):void(0,_.getSuggestions)(e).then(function(e){var t=e.results.find(function(e){return"TRK"===e.q});return t?t.items:[]}).then(function(e){return e.map(function(e){return{value:e.key,label:e.name,organization:e.organization}})}).then(function(e){t(null,{options:e})})},o.handleAddProject=function(e){var t={key:e.value,name:e.label,organization:e.organization};o.setState({addedProjects:[].concat(r(o.state.addedProjects),[t])})},o.renderOption=function(e){return f.default.createElement("span",null,f.default.createElement(v.default,{organizationKey:e.organization,link:!1}),f.default.createElement("strong",null,e.label))},c=n,a(o,c)}return c(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=(0,h.differenceBy)(this.state.addedProjects,e.projects,function(e){return e.key});t.length!==this.state.addedProjects&&this.setState({addedProjects:t})}},{key:"render",value:function(){var e=[].concat(r(this.props.projects),r(this.state.addedProjects));return f.default.createElement("section",null,f.default.createElement("h2",{className:"spacer-bottom"},(0,j.translate)("my_profile.per_project_notifications.title")),0===e.length&&f.default.createElement("div",{className:"note"},(0,j.translate)("my_account.no_project_notifications")),e.map(function(e){return f.default.createElement(m.default,{key:e.key,project:e})}),f.default.createElement("div",{className:"spacer-top panel bg-muted"},g,f.default.createElement(p.default.Async,{autoload:!1,cache:!1,name:"new_project",style:{width:"300px"},loadOptions:this.loadOptions,minimumInput:2,optionRenderer:this.renderOption,onChange:this.handleAddProject,placeholder:"Search Project"})))}}]),t}(f.default.PureComponent),O=function(e){return{projects:(0,N.getProjectsWithNotifications)(e)}};t.default=(0,d.connect)(O)(E);t.UnconnectedProjects=E}});